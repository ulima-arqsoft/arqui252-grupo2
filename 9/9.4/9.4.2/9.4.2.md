> [9. MetodologÃ­a de DiseÃ±o de Arquitectura - AplicaciÃ³n de ADD](../../9.md) â€º [9.4. IteraciÃ³n 3: Refinar estructuras para abordar el atributo de calidad mÃ¡s importante](../9.4.md) â€º [9.4.2. Elementos a refinar](9.4.2.md)

# 9.4.2 Elementos a Refinar

La iteraciÃ³n se centra en mejorar componentes clave del microservicio que afectan directamente al atributo Seguridad.

## Componentes identificados para refinamiento

### ğŸ”¹ 1. Middleware de AutorizaciÃ³n
- Se adicionan **RoleGuard** y **OwnerGuard**.
- Antes solo existÃ­a autenticaciÃ³n; cualquier endpoint mal protegido podÃ­a ser explotado.
- Se busca un **control centralizado, auditable y declarativo**.

### ğŸ”¹ 2. Gestor de Sesiones y Tokens
- El sistema dependÃ­a Ãºnicamente de JWT + refresh tokens.
- No existÃ­a validaciÃ³n contextual de sesiÃ³n (IP, User-Agent).
- Se requieren mecanismos para detectar anomalÃ­as y solicitar reautenticaciÃ³n.

### ğŸ”¹ 3. MÃ³dulo de EnvÃ­o de Correos
- Alto acoplamiento a SendGrid sin fallback.
- Un fallo externo podÃ­a inutilizar registro, login con 2FA y recuperaciÃ³n de contraseÃ±a.

### ğŸ”¹ 4. Flujos de 2FA (Email/TOTP)
- Solo existÃ­a email OTP.  
- Se necesita un modo alterno para disponibilidad y robustez.

### ğŸ”¹ 5. Rutas de AdministraciÃ³n
- Operaciones sensibles (activar admin, suspender usuarios, cambiar tipo de cuenta) no tenÃ­an revalidaciÃ³n reforzada.
- Se refuerzan mediante polÃ­ticas de acceso estrictas y reautenticaciÃ³n.

Estos refinamientos garantizan que el sistema pueda defenderse ante ataques reales y fallos de servicios externos.


[â¬…ï¸ Anterior](../9.4.1/9.4.1.md) | [ğŸ  Home](../../../README.md) | [Siguiente â¡ï¸](../9.4.3/9.4.3.md)