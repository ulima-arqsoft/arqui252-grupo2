> [5. T√°cticas](../5.md) ‚Ä∫ [5.3. M√≥dulo 3 / Integrante 3](5.3.md)

## M√≥dulo 03: Autenticaci√≥n y Seguridad

> **Decisiones base consideradas**: Validar todo en el backend (incluido gateway/middleware), modelo de datos relacional + cach√© (Redis) para sesiones/contadores, Argon2id para hash, JWT de acceso corto + refresh en cookie httpOnly/Secure/SameSite, lockout escalonado y rate limiting en Redis, 2FA TOTP con c√≥digos de respaldo, auditor√≠a m√≠nima y notificaciones de seguridad.

---

### Escenario 1 ‚Äî Confidencialidad por rol y propiedad de recurso

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo**                                           | **Fuente del Est√≠mulo** | **Artefacto**             | **Entorno**  | **Respuesta**                                                                 | **Medida de Respuesta**                        |
|-------------------|--------------------------|--------------------------------------------------------|--------------------------|---------------------------|--------------|--------------------------------------------------------------------------------|-----------------------------------------------|
| ESC-AUTH-SEC-01   | Confidencialidad         | Usuario sin permisos intenta leer datos privados       | Usuario malintencionado  | Endpoints protegidos RBAC | Producci√≥n   | Enforzar control por rol/propiedad en middleware antes de retornar cualquier dato | 100% de endpoints con verificaci√≥n de permisos |

**T√°ctica:** RBAC en gateway/middleware con snapshot de permisos en cach√© (TTL) y *fallback* a BD.  
**Notas:** Mantener registro de denegaciones y causa (rol/permisos insuficientes) para auditor√≠a y afinamiento de pol√≠ticas.

---

### Escenario 2 ‚Äî Integridad de sesi√≥n y tokens

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo**                                                                         | **Fuente del Est√≠mulo** | **Artefacto**       | **Entorno**  | **Respuesta**                                                                                                                           | **Medida de Respuesta**                         |
|-------------------|--------------------------|--------------------------------------------------------------------------------------|--------------------------|---------------------|--------------|------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------|
| ESC-AUTH-SEC-02   | Integridad               | Token con firma inv√°lida o sesi√≥n secuestrada (IP/UA discrepantes o *token replay*) | Atacante                 | Servicio de sesiones | Producci√≥n   | Rechazo inmediato, reautenticaci√≥n/2FA; invalidaci√≥n de tokens previos (lista de revocaci√≥n en Redis) y alerta de nuevo dispositivo     | Detecci√≥n <3s; cierre de sesi√≥n global <6s      |

**T√°cticas:** Verificaci√≥n criptogr√°fica, *anomaly hints* , revocaci√≥n en Redis , exigencia de 2FA si hay riesgo.  
**Notas:** Acceso de refresco √∫nicamente v√≠a cookie httpOnly/ Secure / SameSite para reducir XSS/CSRF.

---

### Escenario 3 ‚Äî Accesos no autorizados y endurecimiento de entradas

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo**                                                                                   | **Fuente del Est√≠mulo** | **Artefacto**                 | **Entorno** | **Respuesta**                                                                                                    | **Medida de Respuesta**                 |
|-------------------|--------------------------|--------------------------------------------------------------------------------------------------|--------------------------|-------------------------------|-------------|-------------------------------------------------------------------------------------------------------------------|------------------------------------------|
| ESC-AUTH-SEC-03   | Seguridad                | Intentos de acceder al panel admin, editar recursos ajenos o subir archivos no permitidos       | Usuario malintencionado  | Gateway + controladores       | Producci√≥n  | Bloqueo inmediato, *logging* de auditor√≠a (<1s), notificaci√≥n y mensaje gen√©rico sin filtrar informaci√≥n sensible | 100% intentos bloqueados y auditados     |

**T√°cticas:** Validaci√≥n estricta en backend, *allowlist* de tipo MIME/extensi√≥n, *logging* de seguridad y notificaciones cr√≠ticas.  
**Notas:** No exponer motivos internos en mensajes de error (evitar *information disclosure*).

---

### Escenario 4 ‚Äî Rate limiting y lockout escalonado en login

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo**                                                           | **Fuente del Est√≠mulo** | **Artefacto**          | **Entorno**  | **Respuesta**                                                                                          | **Medida de Respuesta**            |
|-------------------|--------------------------|------------------------------------------------------------------------|--------------------------|------------------------|--------------|---------------------------------------------------------------------------------------------------------|-------------------------------------|
| ESC-AUTH-SEC-04   | Seguridad                | Alto volumen de intentos de login (picos y *credential stuffing*)      | Usuarios concurrentes    | Endpoint de autenticaci√≥n | Hora pico    | *Rate limiting* por IP/usuario y lockout escalonado con backoff; rechazos en <1s y servicio estable     | Rechazo <1s; error rate <1% en picos |

**T√°cticas:** Contadores en Redis (ejemplo `lock:{userId}`), *rate limiting* a nivel gateway y bloqueo temporal con backoff progresivo.  
**Notas:** Diferenciar trato a IPs compartidas (NAT) vs. IPs √∫nicas para reducir falsos positivos.

---

### Escenario 5 ‚Äî Continuidad de verificaci√≥n (correo/OTP) ante fallos del proveedor

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo**                                              | **Fuente del Est√≠mulo** | **Artefacto**         | **Entorno**  | **Respuesta**                                                                                                              | **Medida de Respuesta**                      |
|-------------------|--------------------------|-----------------------------------------------------------|--------------------------|-----------------------|--------------|-----------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------|
| ESC-AUTH-SEC-05   | Disponibilidad/Seguridad | Ca√≠da intermitente del proveedor de correo/OTP            | Proveedor externo        | Flujo de verificaci√≥n | Producci√≥n   | Reintentos con backoff y ruta alterna (c√≥digos de respaldo TOTP); notificaci√≥n de estado y confirmaci√≥n al usuario          | √âxito ‚â•99% en ‚â§15 min; notificaci√≥n <2 min    |

**T√°cticas:** Reintentos, *fallback* a c√≥digos de respaldo y comunicaci√≥n clara; no bloquear la recuperaci√≥n por dependencia externa.  
**Notas:** Almacenar de forma segura tokens/OTPs

---

### Escenario 6 ‚Äî Pol√≠tica de contrase√±as y no reutilizaci√≥n

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo**                                        | **Fuente del Est√≠mulo** | **Artefacto**           | **Entorno**  | **Respuesta**                                                                                      | **Medida de Respuesta**                     |
|-------------------|--------------------------|-----------------------------------------------------|--------------------------|-------------------------|--------------|-----------------------------------------------------------------------------------------------------|----------------------------------------------|
| ESC-AUTH-SEC-06   | Seguridad                | Intento de establecer contrase√±a d√©bil o reutilizada | Usuario                 | Servicio de credenciales | Producci√≥n   | Rechazo con feedback; verificaci√≥n de complejidad y de `password_history`; rotaci√≥n segura e invalidaci√≥n de sesiones        | 0% contrase√±as d√©biles aceptadas; N hist√≥rico |

**T√°cticas:** Validaci√≥n de complejidad, *password history*, Argon2id con par√°metros calibrados y *pepper*; rotaci√≥n e invalidaci√≥n post-cambio.  
**Notas:** Forzar reautenticaci√≥n reciente para operaciones sensibles.

---

### Escenario 7 ‚Äî Actualizaci√≥n cr√≠tica de librer√≠as (JWT/crypto) sin romper contratos

| **Cod Escenario** | **Atributo de Calidad** | **Est√≠mulo**                                 | **Fuente del Est√≠mulo** | **Artefacto**   | **Entorno**  | **Respuesta**                                                             | **Medida de Respuesta**                   |
|-------------------|--------------------------|----------------------------------------------|--------------------------|-----------------|--------------|----------------------------------------------------------------------------|-------------------------------------------|
| ESC-AUTH-SEC-07   | Mantenibilidad/Seguridad | Vulnerabilidad en librer√≠a JWT o criptograf√≠a | Equipo de seguridad      | AuthService     | Parche urgente | Encapsular librer√≠as detr√°s de *wrapper* estable; actualizaci√≥n sin romper API | Actualizaci√≥n con downtime ‚â§2h (objetivo) |

**T√°ctica:** Wrapper/Adapter con interfaz estable para JWT/crypto  
**Notas:** Pipeline CI con *security checks* y despliegue canario para reducir riesgo.

[‚¨ÖÔ∏è Anterior](../5.2/5.2.md) | [üè† Home](../../README.md) | [Siguiente ‚û°Ô∏è](../5.4/5.4.md)