> [4. Decisiones Iniciales de Arquitectura](../4.md) › [4.2. Módulo 2 / Integrante 2](4.2.md)

# 4.2. Módulo 2 / Integrante 2

## Módulo 02 - Administración General:

#### Asignación de Responsabilidades

**Título:**
Validación de permisos para acceso a funcionalidades de administrador

**Contexto:**  
El módulo permite a los administradores acceder a información sensible del sistema y ejecutar acciones críticas, como modificar el estado o tipo de las cuentas de usuario, configurar categorías de reseñas y otras operaciones restringidas. Por motivos de seguridad, es necesario definir qué componente del sistema (frontend o backend) será responsable de controlar que únicamente los usuarios autorizados, con rol de administrador, puedan acceder a estas funcionalidades.

**Alternativas:**

1. Validar permisos únicamente en el frontend.
2. Validar permisos únicamente en el backend.
3. Aplicar una validación doble (frontend y backend).

**Criterios de elección:**

- Seguridad.
- Escalabilidad para incorporación de nuevos roles.
- Experiencia de usuario (UX).

**Decisión:**  
Se elige aplicar una validación doble, tanto en el frontend como en el backend.

**Sustento:**  
La validación doble proporciona un control más robusto y equilibrado. La verificación en el backend garantiza la protección de los endpoints sensibles y refuerza la seguridad general del sistema, mientras que la validación en el frontend mejora la experiencia del usuario al ocultar dinámicamente las vistas y opciones no autorizadas. Esta combinación mantiene una alta usabilidad sin comprometer la seguridad, y facilita la futura expansión hacia nuevos roles administrativos o jerárquicos.

---
#### Modelo de Coordinación

**Título:**  
Elección de estrategia de actualización del dashboard administrativo entre actualización asíncrona o en tiempo real

**Contexto:**  
El módulo de administración general requiere mostrar métricas agregadas del sistema (usuarios activos, calificaciones recientes, reportes, etc.). Estas métricas pueden variar con el tiempo, pero no son críticas ni requieren información actualizada en tiempo real. Sin embargo, deben mantenerse razonablemente actualizadas para facilitar la toma de decisiones por parte de los administradores.

**Alternativas:**

1. Actualización en tiempo real (sincronía continua):  
	- Utilizar WebSockets o Server-Sent Events (SSE) para actualizar el dashboard en tiempo real.

3. Actualización manual únicamente:  
	- Permitir que el administrador actualice las métricas solo al presionar un botón.

5. Actualización asíncrona programada con control manual:  
	- Refrescar las métricas automáticamente en intervalos definidos (por ejemplo, cada hora) y permitir actualización manual bajo demanda. Se evita la redundancia mediante almacenamiento en caché en el servidor.

**Criterios de elección:**

- Carga del servidor y eficiencia.
- Escalabilidad ante múltiples administradores concurrentes.
- Actualidad y coherencia de la información.
- Facilidad de integración con API REST.

**Decisión:**  
Se adopta una actualización asíncrona programada con control manual por parte del usuario cuando sea necesario.

**Sustento:**  
Dado que las métricas del dashboard no requieren actualizaciones en tiempo real, se opta por una solución eficiente que reduzca la carga del sistema y mantenga la coherencia de los datos. La actualización se ejecutará de forma programada (por ejemplo, cada hora) y los resultados se servirán desde un caché compartido en el backend. Si un administrador actualizó recientemente la información (por ejemplo, hace menos de cinco minutos), las siguientes solicitudes recibirán la misma respuesta, evitando recálculos innecesarios. Esta estrategia garantiza un equilibrio entre eficiencia, coherencia y experiencia de usuario, manteniendo la información actualizada sin afectar el rendimiento del sistema.

---
#### Modelo de Datos

**Título:**  
Implementación de índices en campos críticos para optimizar la generación de métricas del dashboard

**Contexto:**  
El módulo de administración general incluye un dashboard que presenta métricas y reportes sobre usuarios, acciones y actividades. Algunas de estas consultas implican filtrar o agrupar grandes volúmenes de datos (por ejemplo, cantidad de usuarios activos por fecha o tipo de acción). Sin una indexación adecuada, el rendimiento de las consultas podría verse afectado significativamente conforme aumenta la cantidad de usuarios y, con ello, el volumen de datos en la base de datos.

**Alternativas:**

1. **Sin índices adicionales:**  
    - Utilizar únicamente los índices primarios definidos por defecto.
    
2. **Indexación manual en campos clave:**  
    - Crear índices sobre campos utilizados frecuentemente en filtros o agrupaciones (por ejemplo, `fecha_de_accion`, `tipo_de_usuario`, etc.).
    
3. **Indexación automatizada por el ORM o motor de base de datos:**  
    - Permitir que la herramienta de persistencia gestione la creación de índices según los patrones de uso detectados.
    

**Criterios de elección:**

- Rendimiento en consultas de lectura intensiva.
- Escalabilidad del sistema ante el aumento de registros.
- Impacto en el tiempo de escritura o inserción de datos.

**Decisión:**  
Se implementará indexación manual en campos críticos de las tablas más consultadas por el dashboard administrativo.

**Sustento:**  
Esta estrategia ofrece un equilibrio entre rendimiento y control. Permite optimizar las consultas de métricas sin depender de mecanismos automáticos del ORM, los cuales podrían no reflejar las necesidades reales del módulo. Asimismo, la indexación manual facilita el ajuste progresivo de los índices conforme se identifiquen nuevos patrones de uso, priorizando los campos más utilizados en la generación de reportes y métricas administrativas. Esto mejora el tiempo de respuesta del dashboard y contribuye a la escalabilidad y mantenibilidad del sistema.

---
#### Mapeo entre elementos de arquitectura

**Título:**  
Separación de rutas administrativas y validación de acceso mediante middleware por rol de administrador

**Contexto:**  
El módulo de administración general permite realizar acciones críticas como modificar estados de cuenta, eliminar contenido y generar métricas. Estas operaciones deben estar completamente separadas de los flujos de los usuarios comunes (como estudiantes o docentes) para garantizar la seguridad y evitar accesos indebidos.

**Alternativas:**

1. **Rutas separadas y protegidas por middleware:**  
    - Definir rutas del tipo `/admin/usuarios`, `/admin/reseñas`, `/admin/métricas`, protegidas mediante middleware que valide el rol de administrador antes de ejecutar cualquier controlador.
    
2. **Rutas compartidas con control interno en los controladores:**  
    - Utilizar los mismos endpoints para todos los usuarios, pero validar el rol dentro de la lógica del controlador. Esta opción reduce la cantidad de rutas, aunque incrementa el riesgo de errores y accesos indebidos.
    

**Criterios de elección:**

- Seguridad y trazabilidad de acciones.
- Facilidad de mantenimiento y escalabilidad.
- Claridad en la separación entre flujos administrativos y de usuario.

**Decisión:**  
Se implementarán rutas separadas bajo el prefijo `/admin`, protegidas mediante middleware de validación de rol de administrador antes de permitir el acceso a los controladores.

**Sustento:**  
Esta decisión fortalece la seguridad del sistema y facilita la auditoría de operaciones administrativas. Además, mejora la mantenibilidad al mantener la lógica administrativa completamente aislada de los flujos de usuario general. Esta separación clara de responsabilidades permite escalar el sistema e incorporar nuevos roles sin comprometer la integridad ni la trazabilidad de las acciones administrativas.

---
#### Elección de Tecnología

**Título:**  
Elección de Node-Cache frente a Redis como mecanismo de caché para las métricas del dashboard

**Contexto:**  
El módulo de Administración General requiere optimizar el tiempo de respuesta del dashboard, el cual muestra métricas calculadas a partir de grandes volúmenes de datos del sistema. Consultar la base de datos en cada solicitud podría generar una sobrecarga innecesaria y afectar el rendimiento general. Por ello, se necesita una solución de almacenamiento temporal que permita conservar los resultados de las métricas y renovarlos en intervalos definidos, reduciendo el número de consultas directas a la base de datos.

**Alternativas:**

1. **Redis:**  
    - Caché distribuido y persistente, altamente escalable y adecuado para arquitecturas con múltiples instancias o despliegues en clúster. Requiere infraestructura adicional, configuración y mantenimiento del servicio externo.
    
2. **Node-Cache:**  
    - Caché en memoria local, ligero y sencillo de implementar. Permite una integración directa con aplicaciones Node.js sin dependencias externas, aunque su alcance está limitado a una sola instancia del servidor y no ofrece persistencia.

**Criterios de elección:**

- Facilidad de implementación.
- Requerimientos de infraestructura.
- Escalabilidad futura.
- Rendimiento en entornos monolíticos o de baja concurrencia.

**Decisión:**  
Se elige Node-Cache como tecnología de almacenamiento temporal para las métricas del dashboard.

**Sustento:**  
Node-Cache proporciona una solución práctica, eficiente y de rápida implementación para el entorno actual del sistema, que opera bajo una arquitectura monolítica. Su simplicidad permite reducir la latencia de respuesta en el dashboard sin añadir complejidad a la infraestructura. Además, esta elección no compromete la escalabilidad futura, ya que la lógica de caché puede migrarse fácilmente a Redis cuando el sistema evolucione hacia una arquitectura distribuida o requiera persistencia del caché.

---

[⬅️ Anterior](../4.1/4.1.md) | [🏠 Home](../../README.md) | [Siguiente ➡️](../4.3/4.3.md)